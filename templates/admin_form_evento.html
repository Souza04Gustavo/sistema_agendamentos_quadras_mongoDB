{% extends "layout.html" %}
{% block titulo %}Criar Novo Evento{% endblock %}

{% block extra_styles %}
    <style>
        .card-form { background-color: white; border-radius: 12px; padding: 30px; max-width: 800px; margin: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        .quadras-container { max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 5px; }
        .quadras-container label { display: block; margin-bottom: 8px; cursor: pointer; }
        .btn-submit { background-color: var(--cor-principal); color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 1rem; }
        .campos-dinamicos { display: none; }
        .horario-recorrente { display: flex; gap: 20px; } /* Para alinhar os campos de horário */
    </style>
{% endblock %}

{% block conteudo %}
<div class="card-form">
    <h2 style="text-align: center; color: var(--cor-principal);">Criar Novo Evento</h2>
    <form method="POST">
        <!-- Campos de Nome, Admin e Descrição (sem alterações) -->
        <div class="form-group">
            <label for="nome">Nome do Evento:</label>
            <input type="text" name="nome" id="nome" required>
        </div>
        <div class="form-group">
            <label for="cpf_admin_organizador">Admin Organizador:</label>
            <select name="cpf_admin_organizador" id="cpf_admin_organizador" required>
                <option value="">-- Selecione um organizador --</option>
                {% for admin in admins %}
                    <option value="{{ admin.cpf }}">{{ admin.nome }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="descricao">Descrição:</label>
            <textarea name="descricao" id="descricao" rows="3"></textarea>
        </div>
        <div class="form-group">
            <label for="tipo_evento">Tipo de Evento:</label>
            <select name="tipo_evento" id="tipo_evento" required onchange="mostrarCamposEvento()">
                <option value="">-- Selecione o tipo --</option>
                <option value="extraordinario">Extraordinário (Único)</option>
                <option value="recorrente">Recorrente</option>
            </select>
        </div>

        <!-- Campos para Evento Extraordinário (sem alterações) -->
        <div id="campos-extraordinario" class="campos-dinamicos">
            <div class="form-group">
                <label for="data_hora_inicio">Data e Hora de Início:</label>
                <input type="datetime-local" name="data_hora_inicio" id="data_hora_inicio">
            </div>
            <div class="form-group">
                <label for="data_hora_fim">Data e Hora de Fim:</label>
                <input type="datetime-local" name="data_hora_fim" id="data_hora_fim">
            </div>
        </div>

        <!-- ======================= INÍCIO DA ALTERAÇÃO (HTML) ======================= -->
        <!-- Campos para Evento Recorrente (ATUALIZADOS) -->
        <div id="campos-recorrente" class="campos-dinamicos">
            <div class="form-group">
                <label for="dia_semana">Dia da Semana:</label>
                <select name="dia_semana" id="dia_semana">
                    <option value="Monday">Segunda-feira</option>
                    <option value="Tuesday">Terça-feira</option>
                    <option value="Wednesday">Quarta-feira</option>
                    <option value="Thursday">Quinta-feira</option>
                    <option value="Friday">Sexta-feira</option>
                    <option value="Saturday">Sábado</option>
                    <option value="Sunday">Domingo</option>
                </select>
            </div>
            <div class="horario-recorrente">
                <div class="form-group" style="flex: 1;">
                    <label for="hora_inicio_recorrente">Hora de Início:</label>
                    <input type="time" name="hora_inicio_recorrente" id="hora_inicio_recorrente">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="hora_fim_recorrente">Hora de Fim:</label>
                    <input type="time" name="hora_fim_recorrente" id="hora_fim_recorrente">
                </div>
            </div>
            <div class="form-group">
                <label for="data_fim_recorrencia">Data Final da Recorrência:</label>
                <input type="date" name="data_fim_recorrencia" id="data_fim_recorrencia">
            </div>
        </div>
        <!-- ======================== FIM DA ALTERAÇÃO (HTML) ========================= -->

        <!-- Campo de Quadras e botão (sem alterações) -->
        <div class="form-group">
            <label>Quadras a serem Bloqueadas:</label>
            <div class="quadras-container">
                {% for quadra in quadras %}<label><input type="checkbox" name="quadras_selecionadas" value="{{ quadra.id_ginasio }}-{{ quadra.num_quadra }}"> {{ quadra.nome_ginasio }} - Quadra {{ quadra.num_quadra }}</label>{% endfor %}
            </div>
        </div>
        <button type="submit" class="btn-submit">Criar Evento</button>
    </form>
</div>

<script>
    // Script não precisa de alteração
    function mostrarCamposEvento() {
        const tipo = document.getElementById('tipo_evento').value;
        const camposExtra = document.getElementById('campos-extraordinario');
        const camposRecorrente = document.getElementById('campos-recorrente');
        camposExtra.style.display = (tipo === 'extraordinario') ? 'block' : 'none';
        camposRecorrente.style.display = (tipo === 'recorrente') ? 'block' : 'none';
    }
</script>
{% endblock %}